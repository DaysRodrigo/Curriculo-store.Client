name: Merge Dev -> Main

on:
  workflow_run:
    workflows: ["FrontEnd CI"]
    types: [completed]

jobs:
  open-pr:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'success' && github.event.workflow_run.head_branch == 'dev' }}
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Create or update Pull Request from dev to main
        uses: peter-evans/create-pull-request@v5
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
          commit-message: "chore(ci): sync dev -> main (auto PR)"
          branch: "auto/dev-to-main"
          base: main
          title: "Auto: Sync dev â†’ main (CI passed)"
          body: "This PR was created automatically after FrontEnd CI passed on dev. Please review before merge."
          labels: "auto-sync"